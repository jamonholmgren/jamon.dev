name: build-qb64
run-name: ${{ github.actor }} building qb64 executable
on: [push]
jobs:
  download-and-install-qb64:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Download QB64
        run: curl  -L -o ./qb64_lnx.tgz.gz https://github.com/QB64Official/qb64/releases/download/v2.1/qb64_dev_2022-09-08-07-14-00_47f5044_lnx.tar.gz
      - name: Unzip QB64
        run: tar -xf ./qb64_lnx.tgz.gz
      - name: Rename QB64 folder
        run: mv ./qb64_2022-09-08-23-38-12_47f5044_lnx ./qb64
      - name: Run the setup script
        working-directory: ./qb64
        run: ./setup_lnx.sh
      - name: Test qb64
        working-directory: ./qb64
        run: ./qb64 --help
      - name: Create test file
        working-directory: ./qb64
        run: echo "$Console:Only" > ./test.bas
      - name: Try test compile
        working-directory: ./qb64
        run: ./qb64 ./test.bas -x -o ./test_lnx_bin
      - name: List files
        working-directory: ./qb64
        run: ls -al
      - name: Run test file
        working-directory: ./qb64
        run: ./test_lnx_bin
